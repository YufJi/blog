# å®ç°ä¸€ä¸ªç®€æ˜“React UIç»„ä»¶æ–‡æ¡£å°å·¥å…·

>  ä»¥ä¸‹ç¤ºä¾‹ä»£ç ï¼Œå¯èƒ½åŒ…å«å¤šä¸ªæ–‡ä»¶ä»£ç ï¼Œæœ‰ç‚¹ä¹±ã€‚ <br/>
>  è„šæ‰‹æ¶æ„å»ºç”¨åˆ°äº†umi/af-webpackï¼Œæ–‡æ¡£å¸ƒå±€æ ·å¼ç”¨åˆ°äº†vant-uiã€‚


## æ¢³ç†æ€è·¯

- å®ç°ä¸€ä¸ªé€šç”¨è„šæ‰‹æ¶ï¼Œå®Œæˆåˆå§‹åŒ–é¡¹ç›®ï¼Œæ„å»ºï¼Œå‘å¸ƒç»„ä»¶æ–‡æ¡£ã€‚
- è„šæ‰‹æ¶çš„æ„å»ºç¯èŠ‚é€‰ç”¨webpackï¼Œå› ä¸ºæ–‡æ¡£ç«™ç‚¹å…¶å®ä¹Ÿæ˜¯ä¸€ä¸ªåº”ç”¨
- ç»„ä»¶éœ€è¦å…·å¤‡é¢„è§ˆåŠŸèƒ½ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥é‡‡å–MPAçš„æ–¹å¼å¤šå…¥å£æ‰“åŒ…
- çº¦å®šä¸€ä¸ªé…ç½®æ–‡ä»¶ï¼Œé‡Œé¢ä¸»è¦é…ç½®æ–‡æ¡£çš„headerã€sideBarç­‰ï¼Œè¿™éƒ¨åˆ†ä¹Ÿç›¸å½“äºé…ç½®äº†route
- ä½¿ç”¨require.contextåŠ è½½ç”¨æˆ·ç›®å½•ä¸‹çš„mdæ–‡ä»¶

## æ•ˆæœå›¾

<img src="../assets/yufpress.png">

## å¼€å§‹å®ç°

### è„šæ‰‹æ¶

#### åˆå§‹åŒ–
ç®€å•æ¥è®²å°±æ˜¯cliå†…ç½®ä¸€ä¸ªtemplate,å¯ä»¥é€‰æ‹©æ˜¯å¤šä¸ªå›ºå®šçš„ï¼Œä¹Ÿå¯ä»¥å•ä¸ªé€šè¿‡inité˜¶æ®µé…åˆé€‰æ‹©é¡¹æ¥åŠ¨æ€ç”Ÿæˆä¸ªæ€§åŒ–çš„åˆå§‹æ¨¡ç‰ˆï¼ŒæŠ€æœ¯æ–¹æ¡ˆï¼šinquirer + ejsæˆ–mustache

ç¤ºä¾‹ä»£ç ï¼š
```js
async function init() {
  try {
    const answers = await inquirer.prompt(questions);

    const { projectName, platform, framework, attributes, bu, site } = answers;

    const templateRoot = path.join(__dirname, './boilerplate');

    const projectPath = path.join(cwd, projectName);

    await fse.copySync(templateRoot, projectPath, {
      filter: (file) => {
        const reg = /\.(tpl|ejs)$/ig;
        if (reg.test(file)) {
          return false;
        }
        return true;
      },
    });

    const code = fse.readFileSync(path.join(templateRoot, 'config.ejs'), {
      encoding: 'utf8',
    });

    await fse.writeFileSync(
      path.join(projectPath, 'config.js'),
      ejs.render(
        code,
        {
          projectName,
          platform,
          framework,
          attributes,
          bu,
          site,
        },
      ),
      {
        encoding: 'utf8',
      },
    );
    signale.success(chalk.cyan('åˆ›å»ºé¡¹ç›®æˆåŠŸï¼'));
    signale.info(chalk.cyan('npm run dev å¼€å§‹å·¥ä½œå§!ï¼ğŸ˜'));
  } catch (error) {
    signale.error(error);
  }
}
```

#### æ„å»º

è„šæ‰‹æ¶ä¸­æ„å»ºåŠŸèƒ½ä½¿ç”¨çš„æ˜¯webpackï¼Œä¸ºäº†å¿«é€Ÿå®ç°ï¼Œæ‰€ä»¥ç›´æ¥é‡‡ç”¨å¹¶äºŒæ¬¡å°è£…äº†umiå†…éƒ¨çš„af-webpackçš„é…ç½®æ–¹æ¡ˆğŸ‘ï¼Œå½“æ‰§è¡Œè„šæ‰‹æ¶æ„å»ºå‘½ä»¤æ—¶ï¼Œå°†æœ¬åœ°çš„é…ç½®çš„ç›¸å…³å‚æ•°é€ä¼ ç»™af-webpackå³å¯ï¼ŒåŸºæœ¬ä¸Šä¸€è·¯ç»¿ç¯ã€‚

- é…ç½®å¤šå…¥å£
```js
  entry: {
    'docs': [
      webpackHotDevClientPath, // å¼€å‘æ€hmr
      path.join(paths.absTmpDirPath, './docs/index.js'),
    ],
    'preview': [
      webpackHotDevClientPath,
      path.join(paths.absTmpDirPath, './preview/index.js'),
    ],
  }
```

- markdownè§£æ

ä¸ºäº†å°†markdownä¹Ÿå½“æˆä¸€ä¸ªç»„ä»¶è¾“å‡ºï¼Œä¿ç•™æ­£å¸¸markdown-loaderçš„åŠŸèƒ½ï¼Œç¨å¾®å®šåˆ¶åŒ–ä¸€ä¸‹loaderï¼Œè¿™æ ·å¯ä»¥ç›´æ¥å°†front-matteré…ç½®çš„ä¿¡æ¯å‘ˆç°åœ¨é¡µé¢ä¸Šï¼Œå¦‚ä¸‹ï¼š

```js
function transformToComponent(content, fm) {
  const { attributes } = fm;
  return `
    import React, { Component, Fragment } from 'react';

    export default class extends Component {

      state = {
        html: '${escape(content)}',
        attr: ${JSON.stringify(attributes)},
      }

      render() {
        const { html, attr } = this.state;
        const { platform, framework, attributes } = attr;
        return (
          <Fragment>
            {/*<section>
              <blockquote>
                <ul>
                  {platform && <li>Platform: {platform}</li>}
                  {framework && <li>Framework: {framework}</li>}
                  {attributes && <li>Attributes: {attributes}</li>}
                </ul>
              </blockquote>
            </section>*/}
            <section dangerouslySetInnerHTML={{ __html: unescape(html) }} />
          </Fragment>
        )
      }
    }
  `;
}

```

#### å‘å¸ƒ

todo...


### çº¦å®šé…ç½®æ–‡ä»¶ï¼Œ ç¤ºä¾‹ï¼š

```js
module.exports = {
  header: {
    logo: {
      image: 'https://www.baidu.com',
      title: 'YufPress',
      href: '#/'
    },
  },
  // siderBarå³routeï¼Œä¼šè§£ææˆreact-routerçš„å­route
  sideBar: {
    name: 'UI',
    groups: [
      {
        groupName: 'åŸºç¡€ç»„ä»¶',
        list: [
          {
            disabled:  false,
            enablePreview: true, // æ˜¯å¦å¼€å¯é¢„è§ˆ
            path: '/Alert', // è·¯å¾„ï¼ˆå³docsæ–‡ä»¶å¤¹ä¸‹çš„è·¯å¾„
            title: 'Alert',
          },
        ]
      }
    ]
  },
};

```

æ„å»ºæ—¶å¤„ç†æ–¹å¼ï¼Œç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š

```js
// æ”¶é›†æ–‡ä»¶
const docsMap = {};
const req = require.context('@root/docs', true, /\.md$/);

req.keys().forEach((key) => {
  docsMap[key] = req(key);
});

// ç”Ÿæˆroute

import { sideBar } from '@root/config';
const routes = []; // ä¼ ç»™react-routerç”Ÿæˆè·¯ç”±

sideBar.groups.forEach((group) => {
  group.list.forEach((page) => {
    addRoute(page);
  });
});


// addRoute

function addRoute(page) {
  const { path, title, disabled = false } = page;
  if (path) {
    // å…¼å®¹å¤„ç†
    const module =
      componentMap[`.${path}/readme.md`] ||
      componentMap[`.${path}/README.md`] ||
      componentMap[`.${path}.md`] ||
      {};

    if (!disabled) {
      routes.push({
        component: module.default || None,
        name: `${path}`,
        path: `/${path}`,
        title,
      });
    }

  }
}

```

**åŒç†ï¼Œå¤„ç†é¢„è§ˆç»„ä»¶(\.(j|t)sx?)è¿™æ ·çš„æ–‡ä»¶çš„æ–¹å¼ä¸€æ ·**

## æ€»ç»“

å¼€å§‹é™·å…¥æ€è€ƒï¼Œæˆ‘ä¸ºä»€ä¹ˆè¦å†™è¿™ä¸ªï¼Ÿå¥½åƒæ²¡å•¥å¥½å†™çš„ã€‚ä¸‹ç¯‡å‡†å¤‡å†™æˆ‘æ˜¯å¦‚ä½•åœ¨æ­¤åŸºç¡€ä¸Šå®ç°æ’ä»¶æœºåˆ¶çš„ã€‚
